function Invoke-ReviewMalwareInternalUserNotifications
{
    <#
    .SYNOPSIS
        Review notifications for internal users sending malware is enabled.
    .DESCRIPTION
        Ensure the setting Notify an admin about undelivered messages from internal senders is set to On and that there is at least one email address under Administrator email address.
    .EXAMPLE
        Invoke-ReviewMalwareInternalUserNotifications;
    #>

    [CmdletBinding()]   
    Param
    (
    )

    BEGIN
    {
        # Write to log.
        Write-Log -Category 'Defender' -Message 'Getting anti-malware policies' -Level debug;

        # Get malware filter policies.
        $malwarePolicies = Get-MalwareFilterPolicy;

        # Object array to store policies.
        $policies = @();
    }
    PROCESS
    {
        # Foreach malware filter policy.
        foreach ($malwarePolicy in $malwarePolicies)
        {
            # Boolean if malware policy is correctly configured.
            $configuredCorrect = $true;

            # If malware policy have internal user notifications disabled.
            if ($malwarePolicy.EnableInternalSenderAdminNotifications -eq $false)
            {
                # Set the boolean to false.
                $configuredCorrect = $false;
            }

            # If malware policy have no administrator email address.
            if ($null -eq $malwarePolicy.InternalSenderAdminAddress)
            {
                # Set the boolean to false.
                $configuredCorrect = $false;
            }

            # Add to object array.
            $policies += [PSCustomObject]@{
                Guid                                   = $malwarePolicy.Guid;
                Id                                     = $malwarePolicy.Id;
                Name                                   = $malwarePolicy.Name;
                ConfiguredCorrect                      = $configuredCorrect;
                EnableInternalSenderAdminNotifications = $malwarePolicy.EnableInternalSenderAdminNotifications;
                InternalSenderAdminAddress             = $malwarePolicy.InternalSenderAdminAddress;
            };
        }
    }
    END
    {
        # Return the object array.
        return $policies;
    }
}